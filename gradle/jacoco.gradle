jacoco {
    toolVersion = "0.8.8"
}

tasks.named("jacocoTestReport") {
    executionData(file("${project.buildDir}/jacoco/test.exec"))

    reports {
        html.required.set(true);
        html.outputLocation.set(file("$buildDir/reports/jacoco/html"))
    }

    classDirectories.setFrom(
            files(
                    classDirectories.files.collect {
                        fileTree(it) {
                            exclude("**/obama/ObamaApplication**")
                            exclude("**/model/**")
                            exclude("**/entity/**")
                            exclude("**/handler/**")
                            exclude("**/exception/**")
                            exclude("**/configuration/")
                            exclude("**/exchange/**")
                        }
                    }
            )
    )

    dependsOn(tasks.test)
}
